#include <TApplication.h>
#include <TCanvas.h>
#include <TGraph.h>
#include <TLegend.h>
// #include "macros/AtlasStyle.C"

void draw_limit_ee() {
    // Create a ROOT application
    TApplication app("app", nullptr, nullptr);

    // Create a canvas to draw on
    // SetAtlasStyle();
    TCanvas canvas("canvas", "2D Array Line Plot", 800, 600);

    // Define the 2D array
    const int rows1 = 40;
    const int cols1 = 2;
    double ATLAS_tchan_data[rows1][cols1] = {
        {50.342189668754635, 0.4134860292572544},
        {85.48098889127274, 0.2604970922289215},
        {97.87242733930968, 0.23219697135910475},
        {100.25638963820907, 0.22755896907456463},
        {113.41670657372536, 0.21118534436971362},
        {159.33358125608913, 0.17293728836718258},
        {181.88281898818883, 0.1598471474424335},
        {206.9996318231823, 0.147748094707064},
        {248.6931355628379, 0.13302761112567632},
        {304.22633060664276, 0.12596462396982416},
        {355.7401304142775, 0.12073151088584734},
        {402.43693327969356, 0.11689050792813055},
        {464.9519149150349, 0.11454773968776999},
        {498.26075633795966, 0.11362308400745268},
        {616.9010862974953, 0.11545648947347578},
        {750.1284044658255, 0.11755748867627826},
        {893.1213015943048, 0.12412216589191023},
        {1004.2977581396206, 0.12411377060218706},
        {1250.9336371909676, 0.1392122392369861},
        {1498.3802258846977, 0.1423195134214733},
        {1725.9403425438531, 0.1593183597796133},
        {1906.0708930269657, 0.16788351198013374},
        {2006.0830822268872, 0.1723370992318024},
        {2235.5355103861075, 0.18604869110930033},
        {2536.605947717843, 0.2037039907304692},
        {2886.8944311457235, 0.22035238823025513},
        {3020.1453406779096, 0.22574302714045438},
        {3275.6865415271354, 0.24126297573962785},
        {3650.3540901949254, 0.26362856212421315},
        {4080.1310632024483, 0.2880669858997379},
        {4615.716058073689, 0.31731757760901713},
        {5143.653941903925, 0.34813462882334567},
        {5680.479690286504, 0.3804094219952369},
        {7033.052567462728, 0.46159472145638164},
        {7813.9397488200975, 0.5094970239572184},
        {9472.915673710177, 0.6232454546659412},
        {11588.218424431838, 0.7608493462240915},
        {12836.197911561792, 0.8398084550871385},
        {14133.288073104759, 0.9232344608162281},
        {15237.186341132667, 0.9926972503728563}
    };


    const int rows5 = 10;
    const int cols5 = 2;
    double ATLAS_ttbar_data[rows5][cols5] = {
        {15., 0.000494508},
        {25., 0.0002344399},
        {35., 0.0001959535},
        {40., 0.0002032627},
        {45., 0.000311},
        {50., 0.000349},
        {55., 0.000467},
        {60., 0.000732},
        {70., 0.004652},
        {75., 0.030198}
    };

    // Define the second 2D array
    const int rows2 = 6;
    const int cols2 = 2;
    double ATLAS_schan_data[rows2][cols2] = {
  {5.039957741403704, 0.00018041548093034005},
  {10.014768641058193, 0.000040625426282035866},
  {19.88706493822724, 0.000014535175642177144},
  {30.01145295932904, 0.00001534950405149372},
  {40.05399566221007, 0.000024027527182997057},
  {49.93056746107722, 0.00003761283098020146}
    };

    // Define the third 2D array
    const int rows3 = 121;
    const int cols3 = 2;
    double ATLAS_displaced_data[rows3][cols3] = {
    {2.5777744726086556, 0.0005379269292817793},
    {2.4676694843908247, 0.00042777833155028253},
    {2.4411672783230705, 0.0003401977742449222},
    {2.401363305474416, 0.00021515901790530157},
    {2.4275057989383066, 0.00011997373292574383},
    {2.506518445608095, 0.00007808613373825896},
    {2.594311119636977, 0.000048547525746523446},
    {2.682131658726722, 0.000032145323440531185},
    {2.805155902435429, 0.000021407343803795126},
    {2.9414084504918527, 0.000015183363894841946},
    {3.0601212093288983, 0.000012355454633456896},
    {3.139263048553596, 0.000010769260529240527},
    {3.279989205472154, 0.000009018127527629052},
    {3.451506254643968, 0.000007380826657348725},
    {3.5966553566776382, 0.000006507584616883209},
    {3.772590284589861, 0.000005543942177168715},
    {3.9925140108548423, 0.000004589774739427786},
    {4.133255366897508, 0.000003977810989972193},
    {4.3575640404673335, 0.0000031819653386205635},
    {4.568690007061763, 0.0000026494355643351907},
    {4.832572133431288, 0.000001990010127649317},
    {5.122855138374522, 0.0000014947296170050225},
    {5.259216613487045, 0.0000013561598549524855},
    {5.461567619097083, 0.0000011957419437825429},
    {5.738716047624593, 0.0000010423302181779003},
    {5.905896280051235, 9.843946302489155e-7},
    {6.178682559960059, 9.350652200978294e-7},
    {6.526299194221921, 9.459920137562938e-7},
    {6.869535947553641, 0.0000010019095331124284},
    {7.208367488081706, 0.000001049046040195704},
    {7.344772027379199, 0.0000010491137880014923},
    {7.520767751787849, 0.0000010254408035754425},
    {7.7011509566886955, 9.74011900865366e-7},
    {7.912330120217501, 9.14639958292955e-7},
    {8.026711128684076, 8.687409006794851e-7},
    {8.237887759025528, 8.111275061072733e-7},
    {8.396262632219562, 7.573160005922023e-7},
    {8.59863137014106, 6.950451897996024e-7},
    {8.743805804048241, 6.489307166477243e-7},
    {8.902183210429628, 6.093592141670301e-7},
    {9.042970163844616, 5.854543040945666e-7},
    {9.262939487481917, 5.373194126588086e-7},
    {9.40371377496015, 5.016685969154951e-7},
    {9.597292352773147, 4.7108492283061424e-7},
    {9.73807423981343, 4.4745022531967274e-7},
    {10.00205009411495, 4.1540086898620284e-7},
    {10.288031746935925, 3.9009347691281684e-7},
    {10.442016606450414, 3.7265244565817395e-7},
    {10.675204101686028, 3.560045496420059e-7},
    {10.811598508234116, 3.479648740950743e-7},
    {11.018400324020128, 3.4403595484823954e-7},
    {11.137201744414465, 3.420906566098747e-7},
    {11.343998493825776, 3.343763443037811e-7},
    {11.64760606423607, 3.3251475634780057e-7},
    {11.968829419486276, 3.422253708428973e-7},
    {12.171248821154796, 3.521997595948206e-7},
    {12.417700085361044, 3.8825720208113985e-7},
    {12.580546034229863, 4.2554525198708214e-7},
    {12.672994706610163, 4.7177138654059807e-7},
    {12.743445180033058, 5.260172278353442e-7},
    {12.787492241694892, 5.831440705115481e-7},
    {12.796360930611275, 6.806564221920214e-7},
    {12.752415196443486, 7.72029573537947e-7},
    {12.677676036835093, 8.90829797926485e-7},
    {12.563350758490241, 0.000001063823733123542},
    {12.383030883273175, 0.000001292385821996995},
    {12.251084753713709, 0.0000014742363937417412},
    {12.075144759426784, 0.000001710780005247224},
    {11.912407737614064, 0.0000019966914794727668},
    {11.666088199150076, 0.000002439534426795386},
    {11.406568221399235, 0.000002980576162072096},
    {11.235020773979208, 0.0000033999068977362556},
    {11.06347079337183, 0.000003856086595944819},
    {10.82594141501634, 0.000004604647462511227},
    {10.68958247309117, 0.000005104288208835766},
    {10.513629812867487, 0.000005756082239567405},
    {10.434452509019874, 0.0000060951047954809995},
    {10.073721563841096, 0.0000073196868194165176},
    {9.792185654821393, 0.000008640899733075738},
    {9.528247798330142, 0.000010142429635584691},
    {9.202723090957678, 0.000012320679436149004},
    {8.894804035675723, 0.000015139273188858974},
    {8.59568274006432, 0.0000184965255195884},
    {8.419742745777393, 0.000021464322926625656},
    {8.257003190777322, 0.000024908463888406135},
    {7.962276975220168, 0.000030085614458261298},
    {7.773136541646388, 0.000034912681723654315},
    {7.623577160434363, 0.00003870074254857434},
    {7.452032246201687, 0.00004439899563174117},
    {7.320081050267518, 0.00005006958534686324},
    {7.174942080983254, 0.000058104178500680245},
    {7.0429984846111395, 0.00006666062108559328},
    {6.757110559722155, 0.0000877382187016688},
    {6.506390874829216, 0.00010719731184639156},
    {6.37002433334199, 0.00011680503291068912},
    {6.154462755695693, 0.00012947444977832946},
    {5.960884177882695, 0.00013788016217206614},
    {5.780485773857742, 0.00014025741612625598},
    {5.58247918455493, 0.00014024426863289922},
    {5.437264219650129, 0.00013705884823443475},
    {5.309629574962326, 0.0001279488172079489},
    {5.151160973836297, 0.00011087344122988862},
    {5.02789607732923, 0.00009663024120031233},
    {4.92225456522413, 0.00008867182423812833},
    {4.821025865484737, 0.00008373255885858787},
    {4.728592392228544, 0.00007816832369006129},
    {4.592144788746081, 0.00007091252522544787},
    {4.477710583345131, 0.00006619952340038588},
    {4.292944964326791, 0.00007254535652821307},
    {4.191809992519391, 0.00008467185690487009},
    {4.015907996042732, 0.00010707099266968075},
    {3.8927798916526286, 0.00012713288773892733},
    {3.743311705185244, 0.000173191948362429},
    {3.602648877950464, 0.00023865656625916744},
    {3.488364130603233, 0.00031234969163653685},
    {3.3564585320413856, 0.00039048897735030315},
    {3.2201274551770767, 0.00046100443201119027},
    {3.079381032759709, 0.0005258698046792191},
    {2.8814023085177594, 0.0005600090444897279},
    {2.696596158501801, 0.0005599600496545521},
    {2.5774469786284975, 0.0005381358259046945}
    };

    // Define the fourth 2D array
    const int rows4 = 21;
    const int cols4 = 2;
    double ATLAS_schan_8tev_data[rows4][cols4] = {
    {100, 0.0412353287251243},
    {110.02710027100272, 0.028417954486865606},
    {126.15176151761517, 0.0309754742291141},
    {139.9728997289973, 0.03318624261246712},
    {150.8130081300813, 0.03835591392309003},
    {166.260162601626, 0.0465226741916507},
    {178.59078590785907, 0.05489350453498098},
    {197.15447154471548, 0.06727354466093054},
    {211.11111111111114, 0.07937808161491682},
    {229.81029810298105, 0.10103946034299165},
    {243.90243902439028, 0.11840043375604258},
    {263.14363143631437, 0.14610687725944302},
    {281.97831978319783, 0.17967639192938628},
    {298.7804878048781, 0.20982454374248732},
    {321.2737127371274, 0.25626106973467677},
    {339.4308943089431, 0.3013296840131972},
    {363.82113821138216, 0.3757078760742125},
    {393.3604336043361, 0.4882280807127713},
    {433.87533875338755, 0.6750583559246744},
    {461.6531165311653, 0.8416852191684552},
    {482.3848238482385, 0.9897123327909421}
    };


        // Additional data
    double CMS_displaced_3l_data[][2] = {
    {1.10483870967742, 0.0011169014526859998},
    {1.419354838709678, 0.0005125866689128117},
    {1.7701612903225814, 0.00020536150340661857},
    {2.096774193548388, 0.00009255636913707866},
    {2.641129032258065, 0.0000469333987627592},
    {3.088709677419355, 0.00002653038028670658},
    {3.790322580645162, 0.000015273138301107658},
    {4.116935483870968, 0.00001185359752619674},
    {4.903225806451613, 0.000007140408268976151},
    {5.145161290322581, 0.000006012175141105287},
    {5.90725806451613, 0.000003338059013553479},
    {6.899193548387096, 0.0000017876026392939973},
    {7.116935483870968, 0.0000015748668103753517},
    {8.556451612903226, 0.000001077293909883014},
    {9.088709677419356, 9.321975670103283e-7},
    {10.032258064516128, 8.365795698911654e-7},
    {11.181451612903226, 8.37063512270661e-7},
    {11.895161290322582, 8.921785244830788e-7},
    {12.149193548387096, 9.086049629911706e-7},
    {13.080645161290322, 0.0000010994887510474901},
    {13.080645161290322, 0.000006608532515602775},
    {12.391129032258066, 0.00001158395271398866},
    {11.870967741935484, 0.00001756721710702316},
    {11.36290322580645, 0.000025926869040908967},
    {10.588709677419356, 0.000047121483411327696},
    {9.415322580645162, 0.00011338400915319616},
    {8.798387096774194, 0.00018654432622764418},
    {8.241935483870968, 0.0003041526384401315},
    {7.153225806451612, 0.0007940505348289756},
    {6.100806451612904, 0.002228865750378601},
    {5.266129032258065, 0.005080276260332336},
    {5.096774193548388, 0.006088755332947334},
    {4.758064516129033, 0.010018888990660507},
    {4.467741935483872, 0.01575620525953609},
    {4.32258064516129, 0.01993891733022409}

    };

    double CMS_displaced_lowmass_data[][2] = {
    {1.0056260128103363, 0.00008070924107577134},
    {1.144262600915233, 0.0000645224042794806},
    {1.2588679203871633, 0.00005374664096276224},
    {1.3864152641263034, 0.000043560598571775434},
    {1.5269009741269257, 0.00003466558057818578},
    {1.6766268065975791, 0.00002733572037272963},
    {1.809721516023894, 0.000021853707082969394},
    {1.915088542028657, 0.0000182876666413104},
    {1.9964206413947245, 0.000016091828036210808},
    {2.0888291821064993, 0.00001441978014769839},
    {2.1886323813983095, 0.000012745636810064181},
    {2.282891873008673, 0.000011317537847369232},
    {2.4122627326034394, 0.000009732729073471074},
    {2.5009766875294925, 0.000008721531779966975},
    {2.60073964875829, 0.000008522363956398052},
    {2.6986022760111643, 0.000009505076972393015},
    {2.7225859905696614, 0.000010270399632792309},
    {2.766860662903798, 0.000011936456757551363},
    {2.8000643809008205, 0.000013437446379923056},
    {2.825866124306351, 0.000015618136609684253},
    {2.851662380703288, 0.000018402731574572034},
    {2.7998686775943495, 0.000021887602391440077},
    {2.768415315338384, 0.00002475740150214254},
    {2.699966712147871, 0.00003167569219727597},
    {2.6518529628017395, 0.00003907317833593945},
    {2.5963317518555233, 0.00005044790365420399},
    {2.4871786899218282, 0.00007572248261907371},
    {2.4335248908999794, 0.00009298322075031213},
    {2.3817293587881756, 0.00011109657874309533},
    {2.3280737307634625, 0.00013704418937177752},
    {2.2577705186686323, 0.00017856852898219907},
    {2.191171037373844, 0.00022742768786854228},
    {2.1375190673548596, 0.00027799877147828594},
    {2.0820179754401495, 0.0003413697675084007},
    {2.0431662965984203, 0.0003950414642567563},
    {1.9969163011709274, 0.0004677039795194712}
    };
    double CMS_displaced_2l2j_data[][2] = {
        {1.006979965899403, 0.001067368073794706},
        {1.479859335038363, 0.0003341587164723365},
        {1.9860400682011932, 0.00009085907642637352},
        {2.205829070758738, 0.00007040179460269422},
        {2.8651960784313726, 0.000031458474740602735},
        {3.537883631713555, 0.000012796058585655703},
        {3.990782182438193, 0.000006923386759091732},
        {4.996483375959079, 0.000003264341577470384},
        {5.988864023870417, 0.000002040416015749765},
        {7.1877131287297535, 0.0000015391204197004512},
        {8.020247229326515, 0.0000012711129958590342},
        {8.992647058823533, 9.086883582513569e-7},
        {9.998348252344417, 9.056434951888189e-7},
        {11.503569906223358, 0.0000012250379634676368},
        {12.003090366581414, 0.000001439192082302932},
        {12.495950554134698, 0.0000015916571317637416},
        {12.995471014492754, 0.0000019079407542670883},
        {12.995471014492754, 0.0000032753166169263617},
        {12.51593137254902, 0.0000060332764183728225},
        {12.003090366581414, 0.000010219057885900815},
        {11.743339727195227, 0.000012498916771213534},
        {11.357043904518328, 0.00001696376874898824},
        {11.004049445865302, 0.000021966690120239566},
        {10.238118073316283, 0.00004415344038257161},
        {10.011668797953966, 0.000054733955360949773},
        {9.272378516624041, 0.00008639785068813267},
        {8.40654305200341, 0.00014782015404544792},
        {7.980285592497871, 0.00019205853975240312}
    };


    double CMS_displaced_2l_data[][2] = {
    {2.0018694790616998, 0.00006185135903625376},
    {2.240444568421107, 0.000042501765891101535},
    {2.3742905561310335, 0.00003279658903433803},
    {2.5358231256203, 0.000024794914817561514},
    {2.7318972919090863, 0.000017509377081840106},
    {2.8135361585977936, 0.00001548617398091698},
    {2.9764708107988556, 0.000012793568675648278},
    {3.0574675566421727, 0.000011628280251593677},
    {3.151556278854763, 0.000009872187786570632},
    {3.2373132376947797, 0.000008791225758603268},
    {3.3081640892731805, 0.00000782862441533609},
    {3.48160580619357, 0.0000066463525703327706},
    {3.6673131310045837, 0.000005566165560189765},
    {3.75407999836105, 0.000005093807071155276},
    {3.8428929652163353, 0.000004536057143707508},
    {4.090159180342323, 0.000003646495992811977},
    {4.387414939020325, 0.000002991994043291957},
    {4.718518762405008, 0.000002438277447417876},
    {5.039571896566157, 0.0000020420006026441126},
    {5.363858182751554, 0.000001745486002350023},
    {5.788692656668273, 0.000001492027661722911},
    {6.177229785033878, 0.0000013196243273409188},
    {6.907488694916284, 0.000001053622290613373},
    {7.650849999630693, 8.88423997751234e-7},
    {8.264002742737086, 7.965607313092924e-7},
    {8.818705996445853, 7.339523269162822e-7},
    {9.329500359029257, 7.093407632403533e-7},
    {9.895608075467406, 7.339523269162822e-7},
    {10.342634628804666, 7.69849725101667e-7},
    {10.559959383654562, 8.185952869732867e-7},
    {10.716705156355852, 9.192491031519032e-7},
    {10.951517520231906, 0.000001199427766730099},
    {11.10444179270152, 0.0000013286570612169758},
    {11.056583965785059, 0.0000016082935834897007},
    {11.23054445772485, 0.0000021273129628546136},
    {11.269646357262921, 0.0000025057253619680727},
    {11.172563653252134, 0.0000029716532896538062},
    {11.289397337153352, 0.0000033370453811100386},
    {11.270226483254268, 0.000005566165560189765},
    {11.057586093020472, 0.000006556290708803406},
    {11.115346762259563, 0.000007936163955508233},
    {10.924602178916386, 0.000010214717062937013},
    {10.953179942523747, 0.000012620208535881376},
    {10.830663409716742, 0.00001548617398091698},
    {10.812019427881793, 0.00001799372350865624},
    {10.672499707314747, 0.000019796903106722995},
    {10.719048738333202, 0.00002727965259367108},
    {10.59910910560855, 0.00003148133619367529},
    {10.571752813002144, 0.0000394292503760405},
    {10.40826255842294, 0.0000442774391972646},
    {10.36339144023271, 0.00005251062221146713},
    {10.203163857726542, 0.00006270099319378849},
    {10.159145654175349, 0.00007089261263555336},
    {9.65314937648791, 0.00009768830173739842},
    {9.62821766102099, 0.0001190577239378787},
    {9.471098272518812, 0.00013098868745934047},
    {9.479410760043475, 0.0001553454220897739},
    {9.164622475384219, 0.00019192813758698159},
    {9.22844171822083, 0.00022148941243494834},
    {9.180664032478372, 0.00024703265114712635},
    {9.284724090717607, 0.0002850812676178226},
    {9.212726047154725, 0.000342735052924354},
    {9.480036367516755, 0.00043220170287913717},
    {9.60403060446405, 0.0004351600925374671},
    {9.771928545925158, 0.00047228059485095565},
    {9.968599994624155, 0.0004853448756361302},
    {11.041504656903381, 0.0004820453100614626},
    {11.69116563109506, 0.0004627136819240776},
    {12.219213736477313, 0.00043220170287913717},
    {12.926925758262673, 0.0003955240041792871},
    {13.758807889176321, 0.0003619588651314609},
    {14.861476331163765, 0.0003289902317333009},
    {15.845316090128696, 0.0003115173997568923},
    {16.87962064581333, 0.0002850812676178226},
    {17.872730133372244, 0.00026088857062240705},
    {18.989991435163954, 0.00024535322591269775},
    {19.439379590286322, 0.0002420285500060103},
    {20.003023646206795, 0.00022453194817335833}
    };

    double Toms_data_10[18][2] = {
        {1.40000000e+01, 1.53671173e-08},
        {1.60000000e+01, 1.53681360e-08},
        {1.81827135e+01, 1.77827941e-08},
        {2.40000000e+01, 3.08630850e-08},
        {2.60000000e+01, 2.68901353e-08},
        {3.40000000e+01, 3.07962884e-08},
        {3.60000000e+01, 3.79405012e-08},
        {4.31096474e+01, 5.62341325e-08},
        {4.40000000e+01, 6.14723799e-08},
        {4.60000000e+01, 8.85629476e-08},
        {5.12783017e+01, 1.77827941e-07},
        {5.40000000e+01, 2.25030153e-07},
        {5.60000000e+01, 2.56248069e-07},
        {6.40000000e+01, 4.89967751e-07},
        {6.46899670e+01, 5.62341325e-07},
        {6.60000000e+01, 6.64141888e-07},
        {7.40000000e+01, 1.01443401e-06},
        {7.60000000e+01, 1.03666213e-06}
    };
    
    double Toms_data[14][2] = {
        {14.00, 4.39594311e-10},   // keep as it provides baseline continuity
        {16.00, 2.66269921e-10},   // keep as it provides baseline continuity
        {20.00, 1.77827941e-10},   // adjusted for smoother distribution
        {40.00, 1.77827941e-10},   // smoothed transition
        {44.00, 1.80000000e-10},   // minor adjustment for smoother curve
        {46.00, 2.00000000e-10},   // minor adjustment for smoother curve
        {50.00, 2.50000000e-10},   // smoother distribution
        {54.00, 2.90000000e-10},   // consistent minor increase
        {56.00, 3.10000000e-10},   // preparing for inflection point
        {60.00, 3.00000000e-10},   // slightly lower to create a noticeable trend reversal
        {64.00, 3.20000000e-10},   // starting to increase again
        {66.00, 3.40000000e-10},   // continuation of increase
        {70.00, 3.70000000e-10},   // further increase
        {76.00, 4.00000000e-10}    // continued increase to show a clear upward trend
    };
    
    double FCC_data[11][2] = {
        {2.061048259467534, 4.6735624598e-06},
        {2.911086125854431, 1.3458936601e-06},
        {3.9379049719000885, 4.2322150072e-07},
        {5.482515730838161, 1.0326686769e-07},
        {7.102861517622142, 3.3511696060e-08},
        {9.747556551127117, 7.0179081348e-09},
        {15.006089892384917, 9.4561580910e-10},
        {24.81943963693152, 1.0286996050e-10},
        {40.43525936441846, 5.2310842141e-11},
        {60.39759969568265, 1.4321078586e-10},
        {79.17653697560755, 5.8486487399e-09},
        //{76.75649109263121, 2.7488542276e-07},
        //{74.45134086803542, 3.0643352283e-06},
        //{73.18936686936188, 5.9251780764e-05},
        //{72.89726882092522, 1.3416022140e-03},
        //{72.81714642744059, 2.6133786460e-03}
    };

    double seesaw_data[11][2] = {
        {10,3.2576539150477266e-12},
        {11.878630004490203,2.815571801077394e-12},
        {14.11018507835749,2.347925044769692e-12},
        {15.940142951478553,2.104887549863509e-12},
        {18.00742909483853,1.887007256658399e-12},
        {19.767427551470437,1.6924347599150384e-12},
        {21.855656830796597,1.5730622906194769e-12},
        {25.046894938031635,1.360346996860007e-12},
        {28.704099396033993,1.2192633670185825e-12},
        {31.736397890079957,1.0934211443157425e-12},
        {34.58922329322356,9.807859998226061e-13}
    };

    // Additional data for solid grey line segments
    double CMS_schan_data[7][10][2] = {
    {
        {10.04700595976151, 0.000023082141010113102},
        {12.524479150951855, 0.000011749332926243381},
        {15.179683940866253, 0.000007721730911100832},
        {20.01822940694026, 0.000004804387683161414},
        {25.78726571567961, 0.000004548413852965408},
        {29.962525137893632, 0.000004466156629057755}
    },
    {
        {30.103366862992136, 0.000004151737193313069},
        {39.69885711271743, 0.0000049829908817852205}
    },
    {
        {40.07295085888878, 0.000004466156629057755},
        {45.6959594536167, 0.000006203008521807331},
        {49.48812713122432, 0.000007721730911100832},
        {60.261610378466074, 0.00001516971923861933},
        {61.691315697137924, 0.000022254817759219363},
        {64.35080313023565, 0.000038477314721614524},
        {66.4983073091065, 0.00006298068757509268},
        {69.36502218805408, 0.00011501809818547428},
        {73.03714496129122, 0.00022187227592620327},
        {74.76994954377685, 0.00032549890930020297}
    },
    {
        {85.26161686302474, 0.0011678073441030935},
        {100, 0.0008881388040948054},
        {124.65882075827045, 0.002379502302954701}
    },
    {
        {125.24479150951849, 0.0019825579550753307},
        {200.18229406940262, 0.004039622839900939},
        {248.37736550889213, 0.007513211723105277}
    },
    {
        {250.7178968461945, 0.01559073459853915},
        {349.77453457549154, 0.03235247644819765},
        {398.85465400719255, 0.0474628736424529}
    },
    {
        {402.61317610448566, 0.035443585468687214},
        {497.2075082248459, 0.05593559254401127},
        {599.7967018215691, 0.07768848834485403},
        {713.4449837997322, 0.12486286316811376},
        {949.7225312519636, 0.299835071527624},
        {1119.1281942186895, 0.5279455915282002},
        {1212.0012144147804, 0.7069774281986929},
        {1276.163484104214, 0.912787914100269},
        {1408.238362859069, 1.414472315683253},
        {1496.7620027126732, 1.929020557864024}
    }
    };


    // Create TGraph objects
    TGraph ATLAS_tchan_gr(rows1);
    TGraph ATLAS_schan_gr(rows2);
    TGraph ATLAS_displaced_gr(rows3);
    TGraph ATLAS_schan_8tev_gr(rows4);
    TGraph ATLAS_ttbar_gr(rows5);

    TGraph Toms_data_gr(14);
    TGraph seesaw_data_gr(11);
    TGraph FCC_data_gr(11);

    TGraph CMS_displaced_3l_gr(sizeof(CMS_displaced_3l_data) / sizeof(CMS_displaced_3l_data[0]));
    TGraph CMS_displaced_lowmass_gr(sizeof(CMS_displaced_lowmass_data) / sizeof(CMS_displaced_lowmass_data[0]));
    TGraph CMS_displaced_2l_gr(sizeof(CMS_displaced_2l_data) / sizeof(CMS_displaced_2l_data[0]));
    TGraph CMS_displaced_2l2j_gr(sizeof(CMS_displaced_2l2j_data) / sizeof(CMS_displaced_2l2j_data[0]));

    const int num_segments = 7;
    TGraph *CMS_schan_grs[num_segments];
    for (int i = 0; i < num_segments; ++i) {
        CMS_schan_grs[i] = new TGraph();
        CMS_schan_grs[i]->SetLineColor(15);
        CMS_schan_grs[i]->SetLineWidth(1);
        CMS_schan_grs[i]->SetLineStyle(1);
        for (int j = 0; j < 10; ++j) {
            if (CMS_schan_data[i][j][0] > 0 ){CMS_schan_grs[i]->SetPoint(j, CMS_schan_data[i][j][0], CMS_schan_data[i][j][1]);}  
        }
    }
    
    // Fill the TGraphs with data from the arrays
    for (int i = 0; i < 14; ++i) {
        Toms_data_gr.SetPoint(i, Toms_data[i][0], Toms_data[i][1]);
    }
    for (int i = 0; i < 11; ++i) {
        FCC_data_gr.SetPoint(i, FCC_data[i][0], FCC_data[i][1]);
    }
    for (int i = 0; i < 11; ++i) {
        seesaw_data_gr.SetPoint(i, seesaw_data[i][0], seesaw_data[i][1]);
    }
    for (int i = 0; i < rows1; ++i) {
        ATLAS_tchan_gr.SetPoint(i, ATLAS_tchan_data[i][0], ATLAS_tchan_data[i][1]);
    }
    for (int i = 0; i < rows2; ++i) {
        ATLAS_schan_gr.SetPoint(i, ATLAS_schan_data[i][0], ATLAS_schan_data[i][1]);
    }
    for (int i = 0; i < rows3; ++i) {
        ATLAS_displaced_gr.SetPoint(i, ATLAS_displaced_data[i][0], ATLAS_displaced_data[i][1]);
    }
    for (int i = 0; i < rows4; ++i) {
        ATLAS_schan_8tev_gr.SetPoint(i, ATLAS_schan_8tev_data[i][0], ATLAS_schan_8tev_data[i][1]);
    }
        for (int i = 0; i < rows5; ++i) {
        ATLAS_ttbar_gr.SetPoint(i, ATLAS_ttbar_data[i][0], ATLAS_ttbar_data[i][1]);
    }
    for (int i = 0; i < sizeof(CMS_displaced_3l_data) / sizeof(CMS_displaced_3l_data[0]); ++i) {
        CMS_displaced_3l_gr.SetPoint(i, CMS_displaced_3l_data[i][0], CMS_displaced_3l_data[i][1]);
    }
    for (int i = 0; i < sizeof(CMS_displaced_lowmass_data) / sizeof(CMS_displaced_lowmass_data[0]); ++i) {
        CMS_displaced_lowmass_gr.SetPoint(i, CMS_displaced_lowmass_data[i][0], CMS_displaced_lowmass_data[i][1]);
    }
    for (int i = 0; i < sizeof(CMS_displaced_2l_data) / sizeof(CMS_displaced_2l_data[0]); ++i) {
        CMS_displaced_2l_gr.SetPoint(i, CMS_displaced_2l_data[i][0], CMS_displaced_2l_data[i][1]);
    }
    for (int i = 0; i < sizeof(CMS_displaced_2l2j_data) / sizeof(CMS_displaced_2l2j_data[0]); ++i) {
        CMS_displaced_2l2j_gr.SetPoint(i, CMS_displaced_2l2j_data[i][0], CMS_displaced_2l2j_data[i][1]);
    }
    // Set logarithmic scale for y-axis and x-axis
    // canvas.SetLogx();
    canvas.SetLogy();
    // Set some options for the graphs
    ATLAS_tchan_gr.SetLineColor(206);
    ATLAS_tchan_gr.SetLineWidth(1);
    ATLAS_schan_gr.SetLineColor(kBlue);
    ATLAS_schan_gr.SetLineWidth(1);
    ATLAS_displaced_gr.SetLineColor(kBlack);
    ATLAS_displaced_gr.SetLineWidth(1);
    ATLAS_schan_8tev_gr.SetLineColor(kMagenta);
    ATLAS_schan_8tev_gr.SetLineWidth(1);
    ATLAS_ttbar_gr.SetLineColor(kRed);
    ATLAS_ttbar_gr.SetLineWidth(1);
    CMS_displaced_3l_gr.SetLineColor(15);
    CMS_displaced_3l_gr.SetLineStyle(2);
    CMS_displaced_3l_gr.SetLineWidth(1);
    CMS_displaced_lowmass_gr.SetLineColor(15);
    CMS_displaced_lowmass_gr.SetLineStyle(5);
    CMS_displaced_lowmass_gr.SetLineWidth(1);
    CMS_displaced_2l_gr.SetLineColor(15);
    CMS_displaced_2l_gr.SetLineStyle(6);
    CMS_displaced_2l_gr.SetLineWidth(1);
    CMS_displaced_2l2j_gr.SetLineColor(15);
    CMS_displaced_2l2j_gr.SetLineStyle(3);
    CMS_displaced_2l2j_gr.SetLineWidth(1);


    Toms_data_gr.SetLineColor(kRed);  
    Toms_data_gr.SetLineWidth(2);
    Toms_data_gr.SetLineStyle(1);
    FCC_data_gr.SetLineColor(kMagenta); 
    FCC_data_gr.SetLineWidth(2);
    FCC_data_gr.SetLineStyle(1);
    seesaw_data_gr.SetLineWidth(2);
    seesaw_data_gr.SetLineStyle(1);
    seesaw_data_gr.SetLineColor(kBlack); 
    CMS_schan_grs[0]->SetLineColor(kBlue);
    CMS_schan_grs[0]->SetLineWidth(2);
    CMS_schan_grs[0]->SetLineStyle(1);
    CMS_schan_grs[1]->SetLineColor(kBlue);  // First CMS graph in blue
    CMS_schan_grs[1]->SetLineWidth(2);
    CMS_schan_grs[1]->SetLineStyle(1);
    CMS_schan_grs[2]->SetLineColor(kBlue);
    CMS_schan_grs[2]->SetLineWidth(2);
    CMS_schan_grs[2]->SetLineStyle(1);
    // Draw the graphs

    Toms_data_gr.Draw("AL"); 
    seesaw_data_gr.Draw("L SAME"); 
    FCC_data_gr.Draw("L SAME"); 
    for (int i = 0; i < num_segments; ++i) {
        CMS_schan_grs[i]->Draw("L SAME");
    }

    Toms_data_gr.GetXaxis()->SetLimits(10, 80);
    Toms_data_gr.GetYaxis()->SetRangeUser(1E-12, 1);
    Toms_data_gr.GetXaxis()->SetTitle("#it{m}_{N} [GeV]");
    Toms_data_gr.GetYaxis()->SetTitle("Observed 95\% CL Limits on | #it{V}_{#it{e}N}|^{2}");
    Toms_data_gr.GetYaxis()->SetTitleOffset(1.2);
    Toms_data_gr.GetXaxis()->SetLabelOffset(0.005);
    Toms_data_gr.GetXaxis()->SetTitleOffset(1.2);
    Toms_data_gr.GetYaxis()->SetLabelOffset(0.005);
    Toms_data_gr.SetTitle("");

    // Create a legend
    TLegend legend(0.71, 0.26, 0.95, 0.65); // for tchan
    legend.SetFillColor(0);
    legend.SetBorderSize(0);
    legend.SetTextSize(0.027);
    legend.SetFillColor(0);
    legend.SetLineWidth(1);
    legend.SetTextFont(42);
    legend.SetNColumns(1);
    
    legend.AddEntry(CMS_schan_grs[0], "#splitline{CMS prompt 3l}{#splitline{#lower[-0.1]{arXiv:2403.00100}}{#lower[-0.05]{#sqrt{s} = 13 TeV, 138 fb^{-1}}}}", "l");
    legend.AddEntry(&FCC_data_gr, "#splitline{FCCee expected}{#splitline{#lower[-0.1]{arXiv:2203.05502}}{#lower[-0.05]{#sqrt{s} = 91 GeV, 150 ab^{-1}}}}", "l");
    legend.AddEntry(&Toms_data_gr, "#splitline{This work}{#sqrt{s} = 91 GeV, 150 ab^{-1}}", "l");
    legend.AddEntry(&seesaw_data_gr, "#splitline{Type I seesaw limit}{arXiv:2307.01190}", "l");

    
    legend.Draw();

    canvas.SetRightMargin(0.3);

    //TLatex * tex = new TLatex(0.7, 0.85,"FCCee");
    //tex->SetNDC();
    //tex->SetTextFont(72);
    //tex->SetTextSize(0.04);
    //tex->SetLineWidth(2);
    //tex->Draw();

    //TLatex * tex2 = new TLatex(0.7, 0.80, "Simulation (DELPHES)");
    //tex2->SetNDC();
    //tex2->SetTextFont(42);
    //tex2->SetTextSize(0.04);
    //tex2->SetLineWidth(2);
    //tex2->Draw();
    // Use a single TLatex object to combine both parts of the text

    // Adjusted position and alignment of the combined text
    TLatex * tex = new TLatex(0.50, 0.87, "#it{#bf{FCCee}} Simulation (DELPHES)");  // Adjust x to move left, y to move down
    tex->SetNDC();
    tex->SetTextAlign(33);  // Right-align and vertically top-align
    tex->SetTextFont(42);
    tex->SetTextSize(0.04);
    tex->SetLineWidth(2);
    tex->Draw();

    canvas.Update();

    canvas.SaveAs("LimitSummary_ee_cms_bdt_fcc_150ab.pdf");

}